<div *ngIf="loaded">
  <app-toast #toast></app-toast>
  <app-producto-modal #productoModal [producto]="productoSeleccionado"></app-producto-modal>

  <div class="w-[100%] flex justify-start items-center">
    <button class="btn btn-neutral w-[100%]" routerLink="/administracion/crear-producto">Crear</button>
  </div>

  <div class="my-7 prose lg:prose-xl">
    <h1>Productos</h1>
    <p>Productos del sistema</p>
  </div>

  <div class="flex justify-center mb-4">
    <div class="join">
      <button class="btn join-item" [class.btn-primary]="filtro === 'todos'"
        (click)="cambiarFiltro('todos')">Todos</button>
      <button class="btn join-item" [class.btn-primary]="filtro === 'activos'"
        (click)="cambiarFiltro('activos')">Activos</button>
      <button class="btn join-item" [class.btn-primary]="filtro === 'inactivos'"
        (click)="cambiarFiltro('inactivos')">Inactivos</button>
    </div>
  </div>

  <div *ngIf="productosPaginados.length > 0; else noProductos"
    class="grid lg:grid-cols-4 md:grid-cols-3 sm:grid-cols-1 gap-4 mb-8">
    <div *ngFor="let foo of productosPaginados" class="card card-compact w-[100%] bg-base-100 shadow-xl">
      <figure>
        <img *ngIf="foo.imagen !== ''" class="transition-all cursor-pointer max-h-56" (click)="consulta(foo.id)"
          [src]="foo.imagen" alt="Imagen del producto" />
        <img *ngIf="foo.imagen == ''" class="transition-all cursor-pointer max-h-56" (click)="consulta(foo.id)"
          src="/assets/no-image.png" alt="Imagen del producto" />
      </figure>
      <div class="card-body">
        <h2 class="card-title hover:text-primary cursor-pointer transition-all" (click)="consulta(foo.id)">
          {{foo.nombre}}
        </h2>
        <p>{{foo.descripcion}}</p>
        <div class="card-actions justify-end items-center">
          <input (change)="cambiarEstado(foo)" type="checkbox" class="toggle toggle-info" [checked]="foo.isActive" />
          <button class="btn btn-primary" (click)="editar(foo.id)">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              class="inline-block h-5 w-5 stroke-current">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noProductos class="flex w-full justify-center">
    <div class="flex justify-center w-full">
      <div class="text-center my-7 prose lg:prose-xl">
        <h2>No hay productos con estas características</h2>
        <p>Cambia el filtro o crea un nuevo producto para tener algo que listar.</p>
      </div>
    </div>
  </ng-template>

  <div class="flex items-center justify-center mt-4 p-1 gap-1" *ngIf="productosPaginados.length > 0">
    <button class="btn btn-sm" [disabled]="paginaActual === 1" (click)="cambiarPagina(paginaActual - 1)">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
        class="inline-block h-5 w-5 stroke-current">
        <path stroke-linecap="round" stroke-linejoin="round" d="m18.75 4.5-7.5 7.5 7.5 7.5m-6-15L5.25 12l7.5 7.5" />
      </svg>
    </button>
    <span class="mx-2">Página {{ paginaActual }} de {{ totalPaginas }}</span>
    <button class="btn btn-sm" [disabled]="paginaActual === totalPaginas" (click)="cambiarPagina(paginaActual + 1)">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
        class="inline-block h-5 w-5 stroke-current">
        <path stroke-linecap="round" stroke-linejoin="round" d="m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5" />
      </svg>
    </button>
  </div>
</div>